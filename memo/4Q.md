1. For a 4Q element, first convert 3d space to 2d.
    
    + To do that, first calculate vector $n$
        
        $$\hat n = p_{21} \times p_{31}$$
    
    + Then set x' parallel to vector $p_{21}$

        $$\hat i =  \hat{p_{21}}$$
    
    + generate $\hat j = \hat n \times \hat i$

2. Generate ${K^e}'$

    + as ${K^{e}}'$

        $$
            \begin{aligned}
            {K^e}'  &= \int{B^T D B} d\Omega \\
                    &= \sum{ W_i W_j \left( B^T D B \right) \left|J\right|} \\
            \end{aligned}
        $$
    
    + consider that 

        $$
        \begin{aligned}
            J^e &= GN^{4Q} \left[x^e \; y^e\right]\\
            \left[B^e\right] &= \left(J^e\right)^{-1} GN^{4Q} \\

        \end{aligned}
        $$
    
    we can generate $GN^{4Q}$ first, then generate $J^e$ and $[B^e]$.

    + From $[B^e]$ generate $B$ as 

        $$ B = 
        \left(
            \begin{matrix}
                [B]_{11} & 0 & [B]_{12} & 0 & [B]_{13} & 0 & [B]_{14} & 0 \\
                0 & [B]_{21} & 0 & [B]_{22} & 0 & [B]_{23} & 0 & [B]_{24} \\
                \left[B\right]_{21} & [B]_{11} & [B]_{22} & [B]_{12} & [B]_{23} & [B]_{32} & [B]_{24} & [B]_{14}
            \end{matrix}
        \right) 
        $$

    + Calculate ${K^e_{ij}}'$:

        $$
        \begin{aligned}
            {K^e_{ij}}' &= B^T_{ik} D_{kl} B_{lj} \\
                        &= B_{ki} B_{lj} D_{kl} \\
        \end{aligned}
        $$

        在这里，展开$D_{kl}$,对 $(k,l) = (1,1), (1,2), (2,1), (2,2), (3,3)$ 考虑即可。
    
3. convert $K^e$ by 

    $$ K^e = R^T {K^e}' R $$

    where 

    $$ R = \left(
        \begin{matrix}
            i_0 & i_1 & i_2 & 0 & 0 & 0 & 0 & 0 & 0 \\
            j_0 & j_1 & j_2 & 0 & 0 & 0 & 0 & 0 & 0 \\
            0 & 0 & 0 & i_0 & i_1 & i_2 & 0 & 0 & 0 \\
            0 & 0 & 0 & j_0 & j_1 & j_2 & 0 & 0 & 0 \\
            0 & 0 & 0 & 0 & 0 & 0 & i_0 & i_1 & i_2 \\
            0 & 0 & 0 & 0 & 0 & 0 & j_0 & j_1 & j_2 
        \end{matrix}
        \right)
    $$

    