
    为了获得更好的应力恢复效果，在使用了应力平滑（如~Gauss~点的应力外推）的基础上，我们加入了~SPR~方法。超收敛分片应力恢复方法，亦称~SPR，是通过使用具有超收敛点的高斯积分点对结点进行应力恢复，可以获得比应力平滑方法更高的精度。这里我们以~8H~单元为例进行详细讨论。
    
\subsection{程序原理}
    根据所采用的~$2\times 2\times 2$~点高斯积分，二阶完备多项式就足以保证两点高斯积分精度。而考虑三维完备二阶多项式，共有~10~项~(即~$1, x, y, z, xy, xz, yz, x^2, y^2, z^2$)。显然，为确定这~10~个系数，只需要至少两个单元包含该结点（每个单元含有~8~个高斯点）。因此我们将内部点、边界上的点（边点）、仅在一个单元角上的点（角点）分开讨论。
    
    对于内部点和边点，取它所属于的所有单元作为一个分片，根据公式
    \begin{equation*}
      \Pi = \sum ^n_{k=1} [\sigma_i(x_k,y_k)-p_ka]^2.
    \end{equation*}
    其中，$a = A^{-1}b, A=\sum^n_{k=1}P^T_k P_k, b=\sum^n_{k=1}P^T_k \sigma_i(x_k,y_k)$。只要通过最小二乘求出系数，代入结点的物理坐标，就可以求出结点的恢复应力。
    
    对于角点，取它所在的各个分片在该点应力恢复值的算数平均值。这样既最大限度地利用了高斯点的信息和精度，又不至于增加太多计算量。每个内部点和边点都应当计算并只计算了一次。

\subsection{算法实现}
    步骤如下，具体代码可以参见~SPR8H.cpp，这里使用了~Eigen~的矩阵运算库。
    \begin{enumerate}
      \item 按照单元组循环。
      \item 对该单元组中的每个节点遍历，记录下每个节点所属于的单元数。
      \item 对所属于单元数大于等于~2~的结点遍历，取它所属于的所有单元作为它的分片做最小二乘法，求出~10~个系数。代入该结点的坐标，计算出应力。
      \item 对所属于单元小于~2~的结点，它总会至少出现在一个上一步所述分片中。采用这个分片计算出的拟合系数代入该点物理坐标，计算出恢复应力，并记录下这个点被计算的次数。
      \item 将被计算次数多于一次的结点的应力去算数平均值。
      \item 按照~Tecplot~格式输出结点坐标和对应应力值。
    \end{enumerate}

\subsection{改进效果}
	通过在~Tecplot~中画图得到的效果和对比~ABAQUS~给出的解可以看出，SPR~算法进一步有效地改进了应力精度。并可以完全代替应力平滑，取得更好的效果。
